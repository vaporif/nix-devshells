# Vulnix whitelist - false positives and accepted risks
# https://github.com/nix-community/vulnix#whitelist

# False positives - name collisions (different software with same name)
[git]
comment = "Jenkins Git plugin CVEs, not git VCS"
cve = [
  "CVE-2022-36882",
  "CVE-2022-30947",
  "CVE-2022-36883",
  "CVE-2022-38663",
  "CVE-2021-21684",
  "CVE-2022-36884",
]

[mercurial]
comment = "Jenkins Mercurial plugin CVE, not hg VCS"
cve = ["CVE-2022-43410"]

[dash]
comment = "Plotly Dash (Python web framework) CVE, not dash shell"
cve = ["CVE-2024-21485"]

[rubygems]
comment = "RubyGems.org website auth bypass, not gem CLI tool"
cve = ["CVE-2022-36073"]

[ninja]
comment = "ITRS monitor-ninja SQL injection, not ninja build system"
cve = ["CVE-2021-4336"]

[go]
comment = "ecies/go ECDH library CVE, not Go compiler; bootstrap CVEs are build-time only"
cve = [
  "CVE-2023-49292",
  "CVE-2025-0913",
  "CVE-2025-4674",
  "CVE-2025-47906",
  "CVE-2025-47907",
  "CVE-2025-47912",
  "CVE-2025-58185",
  "CVE-2025-58187",
  "CVE-2025-58188",
  "CVE-2025-58189",
  "CVE-2025-61723",
  "CVE-2025-61724",
  "CVE-2025-61726",
  "CVE-2025-61727",
  "CVE-2025-61728",
  "CVE-2025-61729",
  "CVE-2025-61730",
  "CVE-2025-61731",
  "CVE-2025-68119",
  "CVE-2025-68121",
  "CVE-2025-61732",
  "CVE-2025-22873",
]

[zlib]
comment = "untgz demo utility in contrib/, not core zlib compression library"
cve = ["CVE-2026-22184", "CVE-2023-6992"]

# Build-time only (not in runtime closure)
[lapack]
comment = "Build-time numerical library; out-of-bounds read requires crafted input"
cve = ["CVE-2021-4048"]

# Accepted risks - real CVEs with limited impact in devshell context
[clang]
comment = "Arm TrustZone-M secure state leak; only affects Cortex-M firmware builds"
cve = ["CVE-2024-7883"]

[curl]
comment = "Rust curl crate name collision with libcurl CVEs + real CVEs with limited devshell impact"
cve = [
  "CVE-2022-27776",
  "CVE-2022-27781",
  "CVE-2022-27782",
  "CVE-2022-32206",
  "CVE-2022-32221",
  "CVE-2022-35252",
  "CVE-2022-43552",
  "CVE-2023-28319",
  "CVE-2023-28320",
  "CVE-2023-28321",
  "CVE-2023-28322",
  "CVE-2025-13034",
  "CVE-2025-14017",
  "CVE-2025-14524",
  "CVE-2025-14819",
  "CVE-2025-15079",
  "CVE-2025-15224",
]

[lua]
comment = "DoS via crafted script; only runs trusted dev configs"
cve = ["CVE-2021-43519"]

# Haskell package name collisions (solana shell dependencies)
[Diff]
comment = "Haskell Diff library, CVE details unknown/unrelated"
cve = ["CVE-2024-13278"]

[ShellCheck]
comment = "Haskell ShellCheck CLI, CVE is for VS Code extension"
cve = ["CVE-2021-28794"]

[async]
comment = "Haskell async library, CVE is for npm async package"
cve = ["CVE-2021-43138"]

[hedgehog]
comment = "Haskell property testing library, CVE is for dns-stats/hedgehog"
cve = ["CVE-2021-4276"]

[stringbuilder]
comment = "Haskell stringbuilder, CVE is for node-stringbuilder (Node.js)"
cve = ["CVE-2024-21524"]

[safe]
comment = "Haskell safe library, CVEs are for F-Secure SAFE security product"
cve = [
  "CVE-2022-38164",
  "CVE-2022-47524",
  "CVE-2021-40835",
  "CVE-2021-40834",
  "CVE-2021-44751",
  "CVE-2022-28868",
  "CVE-2022-28869",
  "CVE-2022-28870",
  "CVE-2022-28872",
  "CVE-2022-28873",
  "CVE-2021-33594",
  "CVE-2021-33595",
  "CVE-2021-33596",
  "CVE-2022-38163",
]

# Build-time toolchain
[binutils]
comment = "Memory leaks in objdump with crafted input; build-time only, Debian marks unimportant"
cve = ["CVE-2025-3198", "CVE-2025-8224", "CVE-2025-8225", "CVE-2025-1153"]

[busybox]
comment = "Nix sandbox internal use only; tar UI spoofing + wget HTTP splitting, not user-facing"
cve = ["CVE-2025-60876", "CVE-2025-46394"]

[gcc]
comment = "DISPUTED: -fstack-protector bypass on AArch64 only; doesn't create vulns, reduces protection"
cve = ["CVE-2023-4039"]

[glibc]
comment = "strcmp/strncmp bugs only on IBM Power10 CPUs; not applicable to x86_64/aarch64"
cve = ["CVE-2025-5702", "CVE-2025-5745"]

[libmicrohttpd]
comment = "NULL deref + heap overflow; Nix daemon HTTP API binds localhost only, requires local access"
cve = ["CVE-2025-59777", "CVE-2025-62689"]

[openssl]
comment = "Devshell only; upgrade to 3.6.1+ when available in nixpkgs"
cve = [
  "CVE-2025-11187",
  "CVE-2025-15467",
  "CVE-2025-15468",
  "CVE-2025-15469",
  "CVE-2025-66199",
  "CVE-2025-68160",
  "CVE-2025-69418",
  "CVE-2025-69419",
  "CVE-2025-69420",
  "CVE-2025-69421",
  "CVE-2026-22795",
  "CVE-2026-22796",
]

# Solidity shell dependencies - name collisions and build-time
[ada]
comment = "Ada URL parser C++ library; CVE is for Ada cryptocurrency/blockchain project"
cve = ["CVE-2024-9410"]

[fontforge]
comment = "Build-time font tool; heap buffer overflows require crafted font files"
cve = ["CVE-2025-15276", "CVE-2025-15277", "CVE-2025-15278", "CVE-2025-15279"]

[foundry]
comment = "Palantir Foundry CVE, not Ethereum Foundry toolkit"
cve = ["CVE-2023-30952"]

[giflib]
comment = "Build-time image library; heap buffer overflow requires crafted GIF input"
cve = ["CVE-2024-45993"]

[libmemcached]
comment = "Name collision; CVE is for libmemcached SASL auth bypass, not used in devshell"
cve = ["CVE-2023-27478"]

[libsndfile]
comment = "Build-time audio library; requires crafted audio files to exploit"
cve = ["CVE-2024-50612", "CVE-2024-50613", "CVE-2025-52194", "CVE-2025-56226"]

[memcached]
comment = "Transitive dependency; CVE-2022-26635 is for Memcached SASL auth bypass, not user-facing in devshell"
cve = ["CVE-2022-26635"]

[openmp]
comment = "Intel oneAPI OpenMP CVE, not LLVM OpenMP runtime"
cve = ["CVE-2022-26345"]

[yasm]
comment = "Build-time assembler; all CVEs require crafted assembly input files"
cve = [
  "CVE-2021-33454",
  "CVE-2021-33455",
  "CVE-2021-33456",
  "CVE-2021-33457",
  "CVE-2021-33458",
  "CVE-2021-33459",
  "CVE-2021-33460",
  "CVE-2021-33461",
  "CVE-2021-33462",
  "CVE-2021-33463",
  "CVE-2021-33464",
  "CVE-2021-33465",
  "CVE-2021-33466",
  "CVE-2021-33467",
  "CVE-2021-33468",
  "CVE-2023-30402",
  "CVE-2023-31972",
  "CVE-2023-31973",
  "CVE-2023-31974",
  "CVE-2023-31975",
  "CVE-2023-51258",
]
